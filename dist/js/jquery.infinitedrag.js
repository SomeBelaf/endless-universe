"use strict";!function(m){m.infinitedrag=function(t,e,o){return new i(t,e,o)},m.infinitedrag.VERSION=.3;var i=function(t,e,o){var i=this,f=m(t),h=f.parent();f.css({position:"relative"});var r,l=e||{},s={class_name:"_tile",width:100,height:100,start_col:0,start_row:0,range_col:[-1e6,1e6],range_row:[-1e6,1e6],oncreate:function(t,e,o){t.text(e+","+o)}};for(r in o)void 0!==o[r]&&(s[r]=o[r]);function c(t,e){var o,i,r;t<s.range_col[0]||s.range_col[1]<t||e<s.range_row[0]||s.range_row[1]<e||(p[t][e]=!0,o=t*s.width,i=e*s.height,(r=f.append("<pre></pre>").children(":last")).attr({class:s.class_name,col:t,row:e}).css({position:"absolute",left:o,top:i,width:s.width,height:s.height}),s.oncreate(r,t,e))}"x"==l.axis?s.range_row=[s.start_row,s.start_row]:"y"==l.axis&&(s.range_col=[s.start_col,s.start_col]);function a(){n=h.width(),d=h.height(),w=Math.ceil(n/s.width),_=Math.ceil(d/s.height),s.width,s.height;var t=h.offset(),e=n-s.width,o=d-s.height,t=[-s.range_col[1]*s.width+t.left+e,-s.range_row[1]*s.height+t.top+o,-s.range_col[0]*s.width+t.left,-s.range_row[0]*s.height+t.top];f.draggable("option","containment",t)}function g(){for(var t=f,e=t.parent(),o=t.offset().left-e.offset().left,e=t.offset().top-e.offset().top,i=Math.ceil(-o/s.width)-1,r=Math.ceil(-e/s.height)-1,a=i;a<=i+w;a++)for(var n=r;n<=r+_;n++)void 0===p[a]?p[a]={}:void 0===p[a][n]&&c(a,n)}i.draggable=function(){return f},i.disabled=function(t){if(void 0===t)return f;f.draggable("option","disabled",t),f.css({cursor:t?"default":"move"})},i.move=function(t,e){var o=f.offset(),t=t*s.width,e=e*s.height,e={left:o.left-t,top:o.top-e};"x"==l.axis?e.top=o.top:"y"==l.axis&&(e.left=o.left);o=f.draggable("option","containment");o[0]<=e.left&&e.left<=o[2]&&o[1]<=e.top&&e.top<=o[3]||(e.left<o[0]&&(e.left=o[0]),e.left>o[2]&&(e.left=o[2])),f.offset(e),g()},i.center=function(t,e){var o=s.width*t,i=s.height*e,r=s.width/2,a=s.height/2,n=h.width()/2,t=h.height()/2,e=f.offset(),t={left:-o-(r-n),top:-i-(a-t)};"x"==l.axis?t.top=e.top:"y"==l.axis&&(t.left=e.left),f.offset(t),g()};var n=h.width(),d=h.height(),w=Math.ceil(n/s.width),_=Math.ceil(d/s.height);f.offset({left:h.offset().left-s.start_col*s.width,top:h.offset().top-s.start_row*s.height});for(var p={},u=s.start_col,v=s.start_col+w;u<v&&s.range_col[0]<=u&&u<=s.range_col[1];u++){p[u]={};for(var x=s.start_row,b=s.start_row+_;x<b&&s.range_row[0]<=x&&x<=s.range_row[1];x++)c(u,x)}m(window).resize(function(){a()}),l.drag=function(t,e){g()},f.draggable(l),a()}}(jQuery);